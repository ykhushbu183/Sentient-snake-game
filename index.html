<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Sentient Snake</title>
  <style>
    html,body {
      height:100%;
      margin:0;
      font-family: Inter, system-ui, sans-serif;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      background:#000;
      overflow:hidden;
    }

    /* background with blur */
    body::before {
      content:"";
      position:fixed;
      inset:0;
      background:url("assets/sentient-bg.png") center/cover no-repeat;
      filter:blur(3px);
      z-index:0;
    }

    #wrap {
      position:relative;
      width:500px;
      height:500px;
      border:3px solid #fff;
      border-radius:8px;
      overflow:hidden;
      z-index:1;
      background:#111;
    }
    canvas {
      display:block;
      width:100%;
      height:100%;
    }

    /* HUD */
    #score {
      margin-top:10px;
      font-size:20px;
      background: rgba(0,0,0,0.35);
      padding:6px 12px;
      border-radius:6px;
      color:#fff;
      letter-spacing:0.02em;
      box-shadow: 0 4px 10px rgba(0,0,0,0.4);
      z-index:3;
    }

    /* footer */
    #footer {
      margin-top:6px;
      font-size:14px;
      color:#ddd;
      z-index:3;
    }
    #footer a { color:#1DA1F2; text-decoration:none; font-weight:600; }

    /* overlay Game Over */
    #overlay {
      position:absolute;
      inset:0;
      display:flex;
      align-items:center;
      justify-content:center;
      z-index:4;
      background: rgba(0,0,0,0.55);
      color:#fff;
      font-size:22px;
      flex-direction:column;
      gap:12px;
      visibility:hidden;
    }
    #overlay.show { visibility:visible; }

    .btn {
      background:#1DA1F2;
      color:#fff;
      padding:8px 14px;
      border-radius:8px;
      border:0;
      cursor:pointer;
      font-weight:600;
    }

    /* instructions */
    #hint {
      margin-bottom:8px;
      font-size:13px;
      color:#cfd8dc;
      background:rgba(0,0,0,0.25);
      padding:6px 10px;
      border-radius:8px;
      z-index:3;
    }
  </style>
</head>
<body>
  <div id="hint">Arrows / WASD • Space = pause • Swipe on mobile</div>
  <div id="wrap">
    <canvas id="game"></canvas>
    <div id="overlay">
      <div style="font-size:28px;font-weight:700;">Game Over</div>
      <div id="finalScore">Score: 0</div>
      <button id="restartBtn" class="btn">Restart</button>
    </div>
  </div>
  <div id="score">Score: 0</div>
  <div id="footer"> made by <a href="https://x.com/sonuwork37" target="_blank">@sonuwork37</a> </div>

  <script>
  (function(){
    const canvas = document.getElementById('game');
    const ctx = canvas.getContext('2d');
    const scoreEl = document.getElementById('score');
    const overlay = document.getElementById('overlay');
    const finalScoreEl = document.getElementById('finalScore');
    const restartBtn = document.getElementById('restartBtn');

    const cellSize = 20;
    const speedMs = 100;
    const cols = 25;
    const rows = 25;

    let snake = [];
    let dir = {x:1, y:0};
    let nextDir = {x:1, y:0};
    let food = null;
    let score = 0;
    let tickHandle = null;
    let running = true;

    // load food image
    const foodImg = new Image();
    foodImg.src = "assets/sentient-food.png";

    canvas.width = 500;
    canvas.height = 500;

    function resetGame(){
      snake = [];
      const startLen = 3;
      const cx = Math.floor(cols/2);
      const cy = Math.floor(rows/2);
      for(let i=0;i<startLen;i++){
        snake.push({x: cx - i, y: cy});
      }
      dir = {x:1,y:0};
      nextDir = {x:1,y:0};
      score = 0;
      updateScore();
      spawnFood();
      running = true;
      overlay.classList.remove('show');
      if(tickHandle) clearInterval(tickHandle);
      tickHandle = setInterval(tick, speedMs);
    }

    function spawnFood(){
      while(true){
        const fx = Math.floor(Math.random()*cols);
        const fy = Math.floor(Math.random()*rows);
        if(!snake.some(s => s.x === fx && s.y === fy)){
          food = {x:fx, y:fy};
          break;
        }
      }
    }

    function updateScore(){
      scoreEl.textContent = "Score: " + score;
    }

    function tick(){
      if((nextDir.x === -dir.x && nextDir.y === -dir.y)){} 
      else dir = nextDir;

      const head = { 
        x: (snake[0].x + dir.x + cols) % cols, 
        y: (snake[0].y + dir.y + rows) % rows 
      };

      if(snake.some(s => s.x === head.x && s.y === head.y)){
        gameOver();
        return;
      }

      snake.unshift(head);

      if(head.x === food.x && head.y === food.y){
        score += 10;
        updateScore();
        spawnFood();
      } else {
        snake.pop();
      }

      draw();
    }

    function draw(){
      ctx.clearRect(0,0,canvas.width,canvas.height);

      // draw food
      const fx = food.x * cellSize;
      const fy = food.y * cellSize;
      ctx.drawImage(foodImg, fx, fy, cellSize, cellSize);

      // snake
      for(let i=0;i<snake.length;i++){
        const s = snake[i];
        const x = s.x * cellSize;
        const y = s.y * cellSize;
        ctx.fillStyle = i===0 ? "#00d1b2" : "#4caf50";
        ctx.fillRect(x,y,cellSize,cellSize);
        ctx.strokeStyle = "#111";
        ctx.strokeRect(x,y,cellSize,cellSize);
      }
    }

    function gameOver(){
      running = false;
      clearInterval(tickHandle);
      finalScoreEl.textContent = "Score: " + score;
      overlay.classList.add('show');
    }

    // --- Keyboard Controls (PC) ---
    window.addEventListener('keydown', (e) => {
      if(!running) return;
      if(e.key === 'ArrowUp' || e.key === 'w') nextDir = {x:0,y:-1};
      if(e.key === 'ArrowDown' || e.key === 's') nextDir = {x:0,y:1};
      if(e.key === 'ArrowLeft' || e.key === 'a') nextDir = {x:-1,y:0};
      if(e.key === 'ArrowRight' || e.key === 'd') nextDir = {x:1,y:0};

      if(e.key === ' '){
        if(tickHandle) { clearInterval(tickHandle); tickHandle = null; running = false; }
        else { tickHandle = setInterval(tick, speedMs); running = true; }
      }
    });

    // --- Touch Controls (Mobile Swipe) ---
    let touchStartX = 0;
    let touchStartY = 0;

    canvas.addEventListener('touchstart', (e)=>{
      const t = e.touches[0];
      touchStartX = t.clientX;
      touchStartY = t.clientY;
    });

    canvas.addEventListener('touchend', (e)=>{
      if(!running) return;
      const t = e.changedTouches[0];
      const dx = t.clientX - touchStartX;
      const dy = t.clientY - touchStartY;

      if(Math.abs(dx) > Math.abs(dy)){
        if(dx > 30) nextDir = {x:1, y:0};   // right
        else if(dx < -30) nextDir = {x:-1, y:0}; // left
      } else {
        if(dy > 30) nextDir = {x:0, y:1};   // down
        else if(dy < -30) nextDir = {x:0, y:-1}; // up
      }
    });

    restartBtn.addEventListener('click', resetGame);

    resetGame();
    draw();
  })();
  </script>
</body>
</html>
